/*! pageswitch 2015-06-16 */
!function(a,b,c,d){function e(a,c){"undefined"==typeof b.brickjs&&(b.brickjs={}),brickjs[a]=c}function f(){}function g(a){this._cfgs={pages:"",effect:"scroll",end2end:!0,onSwitchStart:f,onSwitchEnd:f,followEvt:!1,curPageCls:"pt-page-current",movInCls:"pt-page-in"},this.curPage=0,this.showPage=null,this.hidePage=null,this.moving=!1,this.disabled=!1,this.oDrag={direct:0},this._init(a)}g.prototype={switchTo:function(a){this.disabled||this.moving||(this.hidePage=this.pages.eq(this.curPage),this.curPage=a,this.showPage=this.pages.eq(this.curPage),a>this.curPage?this._doSwitch(1):this._doSwitch())},prev:function(){this.disabled||this.moving||!this._cfgs.end2end&&this.curPage<=0||(this._getMovePage(-1),this._doSwitch())},next:function(){this.disabled||this.moving||!this._cfgs.end2end&&this.curPage>=this.pages.length-1||(this._getMovePage(1),this._doSwitch(1))},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},_formatCur:function(){var a=this.pages.length-1;this.curPage=this.curPage<0?a:this.curPage>a?0:this.curPage},_loadStyle:function(){var b=c.createElement("link");b.rel="stylesheet",b.href="http://7xsj6b.com2.z0.glb.clouddn.com/animations.css",a("head").append(b)},_init:function(b){a.extend(this._cfgs,b),this._loadStyle(),this.pages=a(this._cfgs.pages),this.total=this.pages.length,this._bind()},_resetPage:function(a,b){this.moving=!1,this.hidePage.off("webkitAnimationEnd").removeClass([a,this._cfgs.curPageCls].join(" ")).removeAttr("style"),this.showPage.off("webkitAnimationEnd").removeClass([b,this._cfgs.movInCls].join(" ")).removeAttr("style"),this.showPage=this.hidePage=null},_restorePage:function(a,b){this.moving=!1,this.hidePage.removeClass([a].join(" ")).removeAttr("style"),this.showPage.removeClass([b,this._cfgs.curPageCls,this._cfgs.movInCls].join(" ")).removeAttr("style"),this.showPage=this.hidePage=null},_doSwitch:function(a){var b=this,c=0,d=this._getSwitchClasses(a),e=d.outCls,f=d.inCls;this.moving=!0,this._cfgs.onSwitchStart(),this.hidePage.addClass(e).on("webkitAnimationEnd",function(){c++,2==c&&(b._resetPage(e,f),b._cfgs.onSwitchEnd())}),this.showPage.addClass([this._cfgs.curPageCls,this._cfgs.movInCls,f].join(" ")).on("webkitAnimationEnd",function(){c++,2==c&&(b._resetPage(e,f),b._cfgs.onSwitchEnd())})},_getSwitchClasses:function(a){var b="",c="";switch(this._cfgs.effect){case"scroll":a?(b="pt-page-moveToTop",c="pt-page-moveFromBottom"):(b="pt-page-moveToBottom",c="pt-page-moveFromTop");break;case"scale":a?(b="pt-page-scaleDown",c="pt-page-moveFromBottom"):(b="pt-page-scaleDown",c="pt-page-moveFromTop");break;case"cover":a?(b="pt-page-fade",c="pt-page-moveFromBottom"):(b="pt-page-fade",c="pt-page-moveFromTop")}return{outCls:b,inCls:c}},_getMovePage:function(a){this.hidePage=this.pages.eq(this.curPage),this.curPage=this.curPage+a,this._formatCur(),this.showPage=this.pages.eq(this.curPage)},_onTouchStart:function(a,b){this.disabled||this.moving||(this.oDrag.dragable=!0,this.oDrag.eY=a.touches[0].pageY,this._cfgs.onSwitchStart(),a.preventDefault())},_onTouchMove:function(c,d){if(!this.disabled&&this.oDrag.dragable&&!this.moving){var e=c.touches[0].pageY-this.oDrag.eY,f=a(b).height();if(0!=e){if((!this.showPage||this.showPage.length<1||this.oDrag.direct*e<0)&&(this.showPage&&this.oDrag.direct*e<0&&this.showPage.removeAttr("style").removeClass([this._cfgs.curPageCls,this._cfgs.movInCls].join(" ")),this.hidePage=a(d),this._cfgs.end2end?0>e?this.showPage=this.hidePage.next().length>0?this.hidePage.next():this.pages.eq(0):this.showPage=this.hidePage.prev().length>0?this.hidePage.prev():this.pages.eq(this.pages.length-1):0>e?this.showPage=this.hidePage.next():this.showPage=this.hidePage.prev()),this.oDrag.direct=e,this.showPage.length<1)return void(this.moving=!1);e=e>f?f:-f>e?-f:e,this._doMove(e),c.preventDefault()}}},_onTouchEnd:function(a){if(!this.disabled){var b=a.changedTouches[0].pageY-this.oDrag.eY;if(this.oDrag.dragable=!1,this.moving||!this.showPage||this.showPage.length<1)return this.hidePage&&this.hidePage.removeAttr("style").removeClass(this._cfgs.movInCls),void(this.moving=!1);if(this.moving=!0,0==b)return void(this.moving=!1);0>b?a.changedTouches[0].pageY-this.oDrag.eY<-100?(this._moveEnd(1,1),this.curPage++,this.curPage=this.curPage%this.total):this._moveEnd(1,0):a.changedTouches[0].pageY-this.oDrag.eY>100?(this._moveEnd(0,1),this.curPage--,this.curPage=(this.total+this.curPage)%this.total):this._moveEnd(0,0),a.preventDefault()}},_getOMoveEnd:function(c,d){var e={},f=a(b).height();switch(this._cfgs.effect){case"scale":e=c?d?{hide:"scale(0.8)",show:"translate(0,0)"}:{hide:"scale(1)",show:"translate(0,"+f+"px)"}:d?{hide:"scale(0.8)",show:"translate(0,0)"}:{hide:"scale(1)",show:"translate(0,-"+f+"px)"};break;case"scroll":e=c?d?{hide:"translate(0,-"+f+"px)",show:"translate(0,0)"}:{hide:"translate(0,0)",show:"translate(0,"+f+"px)"}:d?{hide:"translate(0,"+f+"px)",show:"translate(0,0)"}:{hide:"translate(0,0)",show:"translate(0,-"+f+"px)"};break;default:e=c?d?{hide:"",show:"translate(0,0)"}:{hide:"",show:"translate(0,"+f+"px)"}:d?{hide:"",show:"translate(0,0)"}:{hide:"",show:"translate(0,-"+f+"px)"}}return e},_getAniTime:function(c,d){var e=a(b).height(),f=500,g=this.showPage[0].style.webkitTransform.match(/translate\(.*,(\-*.*)px\)/)||[],h=Math.abs(Number(g[1]));return f=d?Math.floor(500*h/e):Math.floor(500*(e-h)/e),isNaN(f)?500:100>f?100:f},_moveEnd:function(c,d){var e=this,f=(a(b).height(),this._getOMoveEnd(c,d)),g=0;if(!this.hidePage||this.hidePage.length<1)return void(this.moving=!1);var h=this._getAniTime(c,d);this.hidePage.animate({"-webkit-transform":f.hide,transform:f.hide},h,"linear",function(){g++,2==g&&(d?e._resetPage():e._restorePage(),e._cfgs.onSwitchEnd())}),this.showPage.animate({"-webkit-transform":f.show},h,"linear",function(){g++,2==g&&(d?e._resetPage():e._restorePage(),e._cfgs.onSwitchEnd())})},_doMove:function(c){var d=c>0?-1:1,e=a(b).height(),f="";switch(this._cfgs.effect){case"scroll":f="translate(0,"+-d*Math.abs(c)+"px)";break;case"scale":f="scale("+(1-.2*Math.abs(c)/e)+")";break;default:f=""}this.hidePage.css({"-webkit-transform":f}),this.showPage.addClass([this._cfgs.curPageCls,this._cfgs.movInCls].join(" ")).css({"-webkit-transform":"translate(0,"+d*(e-Math.abs(c))+"px)"})},_bind:function(){var b=this,c=this._cfgs;c.followEvt?a(c.pages).on("touchstart",function(a){b._onTouchStart(a,this)}).on("touchmove",function(a){b._onTouchMove(a,this)}).on("touchend",function(a){b._onTouchEnd(a)}):a(c.pages).on("swipeDown",function(){b.prev()}).on("swipeUp",function(){b.next()})}},e("PageSwitch",g)}("undefined"!=typeof Zepto?Zepto:jQuery,window,document);